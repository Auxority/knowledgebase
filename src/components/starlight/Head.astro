---
import type { Props } from '@astrojs/starlight/props';
import StarlightHead from '@astrojs/starlight/components/Head.astro';
import VtbotStarlight from 'astro-vtbot/components/starlight/Base.astro';

import { pwaInfo } from 'virtual:pwa-info';
// import { pwaAssetsHead } from 'virtual:pwa-assets/head';
---

<!-- https://events-3bg.pages.dev/jotter/starlight/guide/ -->
<VtbotStarlight {...Astro.props} transition:animate="fade">
	<StarlightHead {...Astro.props}><slot /></StarlightHead>
</VtbotStarlight>

<!-- https://vite-pwa-org.netlify.app/frameworks/astro.html -->
{pwaInfo && <Fragment set:html={pwaInfo.webManifest.linkTag} />}
<script>
	import { registerSW } from 'virtual:pwa-register';

	registerSW({
		immediate: true,
		onRegisteredSW(swScriptUrl) {
			console.log('SW registered: ', swScriptUrl);
		},
		onOfflineReady() {
			console.log('PWA application ready to work offline');
		},
	});
</script>

<!-- {
	pwaAssetsHead.themeColor && (
		<meta name="theme-color" content={pwaAssetsHead.themeColor.content} />
	)
}
{
	// @ts-ignore
	pwaAssetsHead.links.map((link) => <link {...link} />)
} -->
